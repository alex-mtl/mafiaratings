<head>
<title>Рейтинг</title>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
</head>
<body>

<h1>Формула подсчета рейтинга</h1>
<ul>
<li>Каждому игроку изначально присваевается рейтинг 0.</li>
<li>В каждой игре считается вероятность победы черной и красной команды. Формула победы такая:
<p style="text-indent: 80px">
	CIV_ODDS = 1 / (1 + 10 ^ (( MAF_RATING_SUM / 3 - CIV_RATING_SUM / 7) / 400))
</p>
<p style="text-indent: 40px">
	Где: CIV_ODDS - шансы на победу красной команды; MAF_RATING_SUM - сумма рейтингов всех черных игроков; CIV_RATING_SUM - сумма рейтингов всех красных игроков.
</p>
<p style="text-indent: 40px">
	Например, предположим играют игроки со следующими рейтингами: мафия 784 + 664 + 608 = 2056; мирные 711 + 628 + 557 + 554 + 525 + 519 + 506 = 4000.
</p>
<p style="text-indent: 40px">
	Тогда:
</p>
<p style="text-indent: 80px">
	CIV_ODDS = 1 / (1 + 10 ^ (( 2056 / 3 - 4000 / 7) / 400)) = 1 / (1 + 10 ^ (( 685.3 - 571.4) / 400)) = 1 / (1 + 10 ^ (113.9 / 400)) = 1 / (1 + 10 ^ 0.285) = 1 / (1 + 1.92) = 1 / 2.93 = 0.342 = 34.2%
</p></li>
<li>Если побеждают мирные, то прибавка к рейтингу будет:
<p style="text-indent: 80px">
	<span style="display: block">Для мирных: CIV_DELTA = 20 * MAF_ODDS = 20 * (1 - CIV_ODDS)</span>
	<span style="display: block">Для мафии:  MAF_DELTA = - 15 * MAF_ODDS = 15 * (CIV_ODDS - 1)</span>
</p>
<p style="text-indent: 40px">
	В случае нашего примера:
</p>
<p style="text-indent: 80px">
	<span style="display: block">CIV_DELTA = 20 * (1 - 0.342) = 13.17</span>
	<span style="display: block">MAF_DELTA = 15 * (0.342 - 1) = -9.87</span>
</p></li>
<li>Если побеждает мафия, то прибавка к рейтингу будет:
</p>
<p style="text-indent: 80px">
	<span style="display: block">Для мирных: CIV_DELTA = - 15 * CIV_ODDS</span>
	<span style="display: block">Для мафии:  MAF_DELTA = 20 * CIV_ODDS</span>
</p>
<p style="text-indent: 40px">
	В случае нашего примера:
</p>
<p style="text-indent: 80px">
	<span style="display: block">CIV_DELTA = - 15 * 0.342 = -5.13</span>
	<span style="display: block">MAF_DELTA = 20 * 0.342 = 6.83</span>
</p></li>
<li>Система не дает игрокам уходить ниже ноля. Если рейтинг игрока становится отрицательным, он принудительно устанавливается в ноль.</li>
</ul>

<h2>Комментарии</h2>
<ul>
<li>Коэффициент победы больше коэффициента поражения - 20 против 15. Это позволяет игрокам накапливать рейтинг со временем. Таким образом игроки которые перестают играть не теряют рейтинг, но и не приобретают ничего. Таким образом они начинают отставать.</li>
<li>Числа 20 и 15 подобраны экспериментально таким образом, чтобы даже игроки с процентом побед ниже 50% зарабатывали некоторый рейтинг, а не имели всегда 0.</li>
<li>Рейтинги шерифа и дона учитываются точно также, как и рейтинги обычных игроков. Мы пробовали систему, где они идут с коэффициентами, она не дала хороших результатов.</li>
</ul>
</body>